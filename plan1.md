# lumos-stock 项目分析与规划文档

## 项目概述

**项目名称**: lumos-stock
**项目定位**: 基于大语言模型的AI赋能股票分析工具
**技术栈**: Wails + Go + Vue3 + NaiveUI
**开发状态**: 活跃开发中（Alpha版本）
**代码仓库**: GitHub - lumos-ai/lumos-stock

**重要更新 (2025-01-16)**:
- ✅ 完成项目品牌重命名: go-stock → lumos-stock
- ✅ 完成技术文档化: API 文档、架构文档
- ✅ 建立改进计划和质量标准

---

## 一、核心功能分析

### 1.1 市场支持范围
- ✅ **A股市场**: 完整支持，包括沪深主板、创业板、科创板、北交所
- ✅ **港股市场**: 已支持（有延迟）
- ✅ **美股市场**: 已支持
- 🚧 **基金/ETF**: 部分支持（可查看净值和估值，计划扩展）

### 1.2 AI智能分析能力
#### 核心AI特性
- **AI大模型集成**: 支持多平台AI模型接入
  - OpenAI兼容接口
  - DeepSeek (deepseek-chat, deepseek-reasoner)
  - Ollama (本地模型)
  - LMStudio (本地模型)
  - AnythingLLM (本地知识库)
  - 硅基流动、火山方舟等聚合平台

- **AI智能体** (基于Cloudwego Eino框架)
  - ReAct Agent架构
  - 工具调用能力 (Function Calling)
  - 多轮对话支持
  - 智能选股策略

- **AI工具集** (12+个工具函数)
  - 股票K线数据获取
  - 股价信息查询
  - 市场新闻分析
  - 财经数据分析
  - 研究报告获取
  - 互动问答数据
  - 板块字典查询
  - 热门策略查询
  - 选股指标分析

### 1.3 数据分析功能
#### 技术分析
- K线图表（日K、周K、月K）
- 技术指标：MACD、RSI、KDJ、BOLL、均线系统
- 分时图展示
- 盘口数据分析
- 资金流向分析
- 成交量分析（OBV等）

- 情感分析
  - 市场情绪分析（整体/个股）
  - 新闻情感分析（带频率权重）
  - 词频统计
  - 情感趋势追踪

- 选股策略
  - 指标选股（自定义条件）
  - AI智能选股（自然语言理解）
  - 热门选股策略
  - 热门股票排名

### 1.4 市场资讯与情报
#### 新闻资讯
- 市场资讯实时获取（支持AI总结分析）
- 个股新闻
- 财联社电报
- 外媒简讯（VIP功能）
- 新闻标签管理
- 新闻推送（支持定时推送）

- 研究报告
  - 个股研报
  - 行业研究报告
  - 机构/券商研报

- 其他情报
  - 公司公告
  - 龙虎榜数据
  - 行业排名
  - 热门话题
  - 热门事件
  - 财经日历
  - 重大事件时间轴
  - 投资者互动问答

### 1.5 用户管理功能
- 股票分组管理
- 自选股/自选基金
- 成本设置
- 预警提醒（价格提醒、钉钉通知）
- 弹幕功能（社区互动）
- 数据持久化（SQLite本地存储）

### 1.6 系统功能
- 跨平台支持（Windows、macOS、Linux）
- 自动更新功能
- 主题切换（深色/浅色）
- 多提示词模板管理
- AI分析结果导出（Markdown）
- 浏览器路径自定义（数据爬取）

## 二、技术架构分析

### 2.1 后端架构（Go）
#### 核心框架
- **Wails v2.11.0**: 桌面应用框架，Go与Web桥接
- **GORM**: ORM框架，SQLite数据库
- **Cloudwego Eino**: AI Agent框架

#### 模块划分
```
backend/
├── agent/          # AI智能体模块
│   ├── agent.go           # Agent核心逻辑
│   ├── agent_api.go       # API接口
│   └── tools/             # AI工具集（12+个工具）
│       ├── choice_stock_by_indicators_tool.go
│       ├── economic_data_tool.go
│       ├── financial_reports_tool.go
│       ├── industry_research_report_tool.go
│       ├── interactive_answer_data_tool.go
│       ├── market_news_tool.go
│       ├── stock_news_tool.go
│       └── ...
├── data/           # 数据层
│   ├── stock_data_api.go       # 股票数据API
│   ├── market_news_api.go      # 市场新闻API
│   ├── openai_api.go           # AI分析API
│   ├── crawler_api.go          # 爬虫API
│   ├── stock_sentiment_analysis.go  # 情感分析
│   └── ...
├── db/             # 数据库层
├── models/         # 数据模型
├── logger/         # 日志模块
└── util/           # 工具函数
```

#### 关键技术点
- **并发处理**: goroutine处理数据同步和更新
- **缓存机制**: freecache实现内存缓存
- **定时任务**: cron实现定时分析和更新
- **Web爬虫**: chromedp（Chrome DevTools Protocol）
- **数据解析**: goquery（HTML解析）
- **HTTP客户端**: resty/v2

### 2.2 前端架构（Vue3）
#### 核心框架
- **Vue 3.5.17**: 渐进式前端框架
- **NaiveUI 2.43.2**: UI组件库
- **Vite 7.2.4**: 构建工具
- **Vue Router 4.5.0**: 路由管理
- **ECharts 5.6.0**: 图表库（K线图、分时图等）

#### 主要组件
```
frontend/src/components/
├── stock.vue                 # 股票详情组件
├── KLineChart.vue           # K线图组件
├── fund.vue                 # 基金组件
├── newsList.vue             # 新闻列表
├── HotStockList.vue         # 热门股票
├── HotTopics.vue            # 热门话题
├── HotEvents.vue            # 热门事件
├── SelectStock.vue          # 选股功能
├── rankTable.vue            # 排行榜
├── moneyTrend.vue           # 资金趋势
├── LongTigerRankList.vue    # 龙虎榜
├── StockResearchReportList.vue    # 个股研报
├── IndustryResearchReportList.vue # 行业研报
├── agent-chat_bk.vue        # AI聊天界面
└── settings.vue             # 设置页面
```

#### 特性
- 响应式设计
- 组件自动导入（unplugin-auto-import）
- Markdown编辑器（md-editor-v3）
- 弹幕功能（vue3-danmaku）
- 图表导出（html2canvas）

### 2.3 数据流设计
```
用户操作 (Vue3)
    ↓
Wails Bindings (Go-JS桥接)
    ↓
后端逻辑 (Go)
    ↓
数据获取层
    ├─ 第三方API (Tushare等)
    ├─ Web爬虫 (chromedp)
    └─ 本地数据库 (SQLite)
    ↓
数据处理与分析
    ├─ AI Agent (Eino)
    ├─ 情感分析
    └─ 技术指标计算
    ↓
数据返回前端 (JSON)
    ↓
UI渲染 (Vue3 + ECharts)
```

### 2.4 依赖管理
#### Go主要依赖
```go
// AI与机器学习
github.com/cloudwego/eino v0.7.9              // AI Agent框架
github.com/cloudwego/eino-ext/components/model/ark    // 火山方舟
github.com/cloudwego/eino-ext/components/model/deepseek  // DeepSeek
github.com/cloudwego/eino-ext/components/model/openai    // OpenAI

// Web与网络
github.com/chromedp/chromedp v0.14.2          // 浏览器自动化
github.com/PuerkitoBio/goquery v1.11.0        // HTML解析
github.com/go-resty/resty/v2 v2.17.0          // HTTP客户端

// 数据库与存储
github.com/glebarez/sqlite v1.11.0            // SQLite驱动
gorm.io/gorm v1.31.1                          // ORM框架
github.com/coocood/freecache v1.2.4           // 内存缓存

// 工具库
github.com/duke-git/lancet/v2 v2.3.8          // Go工具库
github.com/robfig/cron/v3 v3.0.1              // 定时任务
github.com/tidwall/gjson v1.18.0              // JSON解析
```

#### 前端主要依赖
```json
{
  "vue": "^3.5.17",
  "naive-ui": "^2.43.2",
  "echarts": "^5.6.0",
  "vue-router": "^4.5.0",
  "@tdesign-vue-next/chat": "^0.4.5",  // AI聊天组件
  "md-editor-v3": "^5.2.3",            // Markdown编辑器
  "vue3-danmaku": "^1.6.1"             // 弹幕组件
}
```

## 三、当前功能成熟度评估

### 3.1 已完成功能 ✅
1. **市场数据获取**
   - A股实时行情、K线、资金流向
   - 港股/美股基础数据
   - 基金净值估值

2. **AI分析能力**
   - 多模型接入（OpenAI/DeepSeek/Ollama等）
   - AI智能体（ReAct Agent）
   - 12+个工具函数
   - 多轮对话
   - 自定义提示词模板

3. **技术分析**
   - K线图表（支持拉伸放大）
   - 技术指标（MACD、RSI、KDJ、BOLL等）
   - 分时图
   - 盘口数据
   - 资金流向

4. **情感分析**
   - 市场整体情绪
   - 个股情绪
   - 新闻情感（带频率权重）
   - 词频统计

5. **资讯情报**
   - 市场新闻（AI总结）
   - 个股新闻
   - 研究报告
   - 龙虎榜
   - 热门话题/事件
   - 财经日历

6. **系统功能**
   - 跨平台支持
   - 自动更新
   - 主题切换
   - 预警通知（钉钉）
   - 数据持久化

### 3.2 部分完成功能 🚧
1. **基金/ETF支持**
   - 当前：可查看净值和估值
   - ⚠️ 缺少：ETF实时行情、K线数据
   - ✅ **已创建改进方案 (IMPROVEMENTS.md)**

2. **知识库功能**
   - 状态：计划中
   - 说明：股票分析知识库（可能基于AnythingLLM）

3. **技术文档**
   - ✅ **已完成**: API 文档 (docs/API.md)
   - ✅ **已完成**: 架构文档 (docs/ARCHITECTURE.md)
   - 🚧 **待完成**: 开发指南

### 3.3 待优化功能 ⚠️
1. **性能优化**
   - 数据加载速度（港股延迟问题）
   - 大量数据渲染优化
   - 内存占用优化

2. **用户体验**
   - AI智能体体验（当前默认关闭）
   - 错误处理和提示
   - 操作流畅度

3. **数据准确性**
   - 数据源稳定性
   - 实时性保证
   - 多数据源验证

## 四、未来规划分析

### 4.1 短期规划（1-3个月）
基于最近提交记录分析：

#### 已在进行的改进
1. **新闻资讯增强**
   - ✅ 新闻标签功能优化
   - ✅ VIP用户市场资讯自动同步
   - ✅ 新闻推送时间限制和代理配置
   - 🚧 外媒简讯集成

2. **AI能力提升**
   - ✅ AI思考模式
   - ✅ 热门选股策略
   - 🚧 股票分析知识库

3. **数据优化**
   - ✅ 热门股票排名功能
   - ✅ K线数据天数配置优化
   - 🚧 情感分析精度提升

#### 建议短期优先级
1. **高优先级**
   - 修复港股数据延迟问题
   - 优化AI Agent用户体验
   - 完善ETF实时行情支持

2. **中优先级**
   - 增加更多技术指标
   - 扩展数据源（多源验证）
   - 性能优化（加载速度、内存）

3. **低优先级**
   - UI美化
   - 新增图表类型
   - 社区功能增强

### 4.2 中期规划（3-6个月）

#### 功能扩展
1. **知识库系统**
   - 股票分析知识库构建
   - 历史数据分析
   - 投资策略库

2. **高级分析**
   - 量化回测系统
   - 策略收益模拟
   - 风险评估模型

3. **社区功能**
   - 用户策略分享
   - 投资组合追踪
   - 社区讨论区

4. **数据增强**
   - 国际市场扩展（欧洲、日本等）
   - 期货、期权支持
   - 加密货币市场

#### 技术优化
1. **架构升级**
   - 微服务化（可选）
   - 云端数据同步
   - 多设备数据同步

2. **性能提升**
   - 数据缓存策略优化
   - 增量更新机制
   - 并发处理优化

### 4.3 长期规划（6-12个月）

#### 战略方向
1. **商业化**
   - VIP订阅体系完善
   - 高级功能付费
   - 企业版本（B端）

2. **生态建设**
   - 开发者API
   - 插件系统
   - 第三方集成

3. **智能化升级**
   - 自学习AI模型
   - 个性化推荐
   - 预测模型优化

4. **平台扩展**
   - 移动端APP（iOS/Android）
   - Web端版本
   - API服务平台

## 五、技术债务与改进建议

### 5.1 代码质量
1. **测试覆盖**
   - 当前：部分测试文件存在
   - 建议：提升单元测试覆盖率至80%+
   - 优先：核心业务逻辑、AI Agent工具

2. **文档完善** ✅ **[已完成基础]**
   - ✅ README 较完整
   - ✅ API 文档 (docs/API.md)
   - ✅ 架构文档 (docs/ARCHITECTURE.md)
   - 📋 **待添加**: 开发指南 (docs/DEVELOPMENT.md)

3. **代码规范**
   - 建议：统一Go代码风格（gofmt、golint）
   - 建议：Vue组件规范（命名、结构）
   - 建议：添加Git commit规范（Conventional Commits）

### 5.2 架构改进
1. **模块化** 🔴 **[建议重构]**
   - ⚠️ 当前：backend/data 目录文件过多（35个文件）
   - 📋 **建议**: 按功能域拆分（market、analysis、ai、crawler等）
   - ✅ **重构方案已设计 (docs/ARCHITECTURE.md)**

   ```
   backend/data/
   ├── market/          # 市场数据
   ├── analysis/        # 分析功能
   ├── ai/              # AI 相关
   ├── crawler/         # 爬虫功能
   ├── alert/           # 预警通知
   └── config/          # 配置管理
   ```

2. **配置管理**
   - 当前：设置存储在数据库
   - 建议：支持配置文件导入导出
   - 建议：多环境配置管理

3. **错误处理** 🚧 **[待改进]**
   - ⚠️ 当前：部分函数缺少错误处理
   - 📋 **建议**: 统一错误处理机制
   - 📋 **建议**: 添加错误日志和监控
   - ✅ **已制定改进方案 (IMPROVEMENTS.md)**

### 5.3 性能优化
1. **数据库优化** 🚧 **[待实施]**
   - 📋 **建议**: 添加索引优化查询
   - 📋 **建议**: 定期清理历史数据
   - 📋 **建议**: 数据归档机制
   - ✅ **已制定优化方案**

2. **缓存策略** ✅ **[已有基础]**
   - ✅ 当前：freecache 内存缓存
   - 📋 **建议**: 分层缓存（内存+磁盘）
   - 📋 **建议**: 缓存失效策略优化
   - ✅ **已制定优化方案**

3. **前端性能** 🚧 **[待优化]**
   - 📋 **建议**: 组件懒加载
   - 📋 **建议**: 虚拟列表（大数据列表）
   - 📋 **建议**: 图表渲染优化
   - ✅ **已制定优化方案**

## 六、商业模式分析

### 6.1 当前商业模式
基于README中的赞助计划：

| 等级 | 价格 | 权益 |
|------|------|------|
| vip0 | 免费 | 全部功能，GitHub自动更新（需自行解决网络问题） |
| vip1 | 18.8元/月 或 120元/年 | 全部功能，CDN自动更新，AI配置指导，提示词参考 |
| vip2 | 28.8元/月 或 240元/年 | vip1全部功能 + 硅基流动AI分析服务 + 市场资讯自动同步 |

### 6.2 商业化建议
1. **免费版**
   - 基础股票查询
   - 有限的AI分析次数
   - 社区支持

2. **付费版**
   - 无限AI分析
   - 高级策略
   - 优先客服
   - 数据自动同步

3. **企业版**
   - API接入
   - 私有部署
   - 定制开发
   - 技术支持

4. **增值服务**
   - 高级数据源
   - 专业研报
   - 投资顾问
   - 培训课程

## 七、风险分析与建议

### 7.1 技术风险
1. **数据源依赖**
   - 风险：依赖第三方API（Tushare等）
   - 建议：多数据源备份，数据验证机制

2. **AI服务依赖**
   - 风险：依赖第三方AI服务
   - 建议：支持本地模型（Ollama），降低依赖

3. **反爬虫机制**
   - 风险：网站反爬虫策略升级
   - 建议：遵守robots.txt，合理请求频率

### 7.2 法律风险
1. **数据合规**
   - 风险：金融数据使用合规性
   - 建议：数据来源明确，用户协议免责

2. **投资建议**
   - 风险：AI分析结果误导用户
   - 建议：明确免责声明，强调"仅供参考"

3. **知识产权**
   - 风险：开源协议合规
   - 建议：检查所有依赖许可证，Apache 2.0合规

### 7.3 市场风险
1. **竞争激烈**
   - 风险：同类产品众多（同花顺、东方财富等）
   - 建议：差异化定位（AI赋能、本地部署）

2. **用户留存**
   - 风险：用户活跃度下降
   - 建议：社区建设，持续更新，用户反馈

3. **盈利模式**
   - 风险：付费转化率低
   - 建议：免费版价值足够，付费版吸引力强

## 八、总结与展望

### 8.1 项目优势
1. ✅ **技术栈先进**：Wails + Vue3 + AI Agent
2. ✅ **AI能力强大**：多模型支持，智能体架构
3. ✅ **功能丰富**：涵盖股票分析全流程
4. ✅ **跨平台支持**：Windows/macOS/Linux
5. ✅ **开源社区**：活跃开发，Star增长

### 8.2 改进空间
1. ⚠️ **性能优化**：数据加载、渲染性能
2. ⚠️ **用户体验**：AI Agent体验、错误处理
3. ⚠️ **测试覆盖**：单元测试、集成测试
4. ⚠️ **文档完善**：API文档、开发指南

### 8.3 发展建议
1. **短期**：优化核心功能，提升稳定性
2. **中期**：扩展功能边界，增强竞争力
3. **长期**：构建生态体系，实现商业化

### 8.4 最终评价
lumos-stock (原 go-stock) 是一个**技术先进、功能丰富、发展潜力大**的AI赋能股票分析工具。

**最新进展 (2025-01-16)**:
- ✅ 完成品牌重塑：lumos-stock
- ✅ 完成技术文档化：API、架构文档
- ✅ 建立质量标准：改进计划、性能优化方案
- ✅ 为社区贡献奠定基础

**建议优先级**：
1. 🔴 **稳定性优化**（港股延迟、数据准确性）✅ 有方案
2. 🔴 **性能提升**（加载速度、内存占用）✅ 有方案
3. 🟡 **功能完善**（ETF支持、知识库）✅ 有方案
4. 🟡 **用户体验**（AI Agent、错误处理）✅ 有方案
5. 🟢 **商业化推进**（付费转化、企业版）✅ 有方案

---

**文档版本**: v2.0 (已更新 2025-01-16)
**生成日期**: 2026-01-16
**最后更新**: 2025-01-16
**基于提交**: b162e03 (完成！lumos-stock 改造计划已创建)
**项目状态**: ✅ 品牌重塑完成，持续改进中

**相关文档**:
- 📋 [lumos-stock 改造计划](./lumos-stock.md)
- 📖 [API 文档](./docs/API.md)
- 🏗️ [架构文档](./docs/ARCHITECTURE.md)
- 🚀 [改进计划](./IMPROVEMENTS.md)
