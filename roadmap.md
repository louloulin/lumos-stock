# Lumos-Stock AI Agent 智能投资助手 - 整体路线图

> **项目愿景**: 从单一AI聊天工具进化为世界级AI Agent驱动投资助手平台
>
> **时间跨度**: 2026年1月 - 2026年12月 (12个月)
>
> **核心目标**: 构建一人一智能体、千人千策略的个性化AI投资系统

---

## 📋 执行摘要

### 当前状态

```
┌─────────────────────────────────────────────────────────────┐
│                  Lumos-Stock v1.0 (2025基线)                  │
├─────────────────────────────────────────────────────────────┤
│  ✅ 已有功能                                                 │
│    - Cloudwego Eino ReAct Agent框架                         │
│    - 11个基础投资工具                                       │
│    - 3种AI模型支持 (Ark/DeepSeek/OpenAI)                    │
│    - 流式响应 + 思考过程可视化                               │
│    - 完整的股票数据获取和分析能力                           │
├─────────────────────────────────────────────────────────────┤
│  ❌ 核心问题                                                 │
│    - AI聊天渲染Bug (仅显示2字符) - P0                      │
│    - 无用户画像和个性化策略                                 │
│    - 无多Agent协作系统                                     │
│    - 组件库混用导致技术债务                                │
│    - 缺少状态管理和分层架构                                │
└─────────────────────────────────────────────────────────────┘
```

### 目标状态

```
┌─────────────────────────────────────────────────────────────┐
│                Lumos-Stock v2.0 (2026愿景)                    │
├─────────────────────────────────────────────────────────────┤
│  🎯 核心能力                                                 │
│    - Supervisor Agent主控系统                               │
│    - 8个专业Agent协同工作                                   │
│    - 个性化投资策略引擎                                     │
│    - 用户画像和风险评估系统                                 │
│    - 持续学习和优化机制                                     │
├─────────────────────────────────────────────────────────────┤
│  🏗️ 技术架构                                                │
│    - 三层Agent架构 (编排/专家/工具)                         │
│    - 统一的Naive UI设计系统                                 │
│    - Pinia状态管理                                          │
│    - 分层架构 (Service/Repository)                          │
│    - 完整的测试覆盖                                         │
└─────────────────────────────────────────────────────────────┘
```

---

## 🗺️ 总体路线图

### 四个阶段概览

```
2026年完整改造路线:

Q1 (1-3月):  紧急修复 + 基础重构  [修复当前问题]
            ↓
Q2 (4-6月):  个性化Agent开发        [构建差异化能力]
            ↓
Q3 (7-9月):  多Agent协作系统        [实现技术突破]
            ↓
Q4 (10-12月): 学习优化 + 高级功能  [建立竞争壁垒]
```

### 里程碑与交付物

| 阶段 | 时间 | 核心目标 | 关键交付物 | 成功指标 |
|------|------|---------|-----------|---------|
| **Q1** | 1-3月 | 修复Bug + 建立基础 | 渲染修复、架构重构、状态管理 | Bug清零、架构清晰 |
| **Q2** | 4-6月 | 个性化Agent系统 | 用户画像、策略引擎、动态Agent构建 | 画像完成率>70% |
| **Q3** | 7-9月 | 多Agent协作 | 8个专业Agent、Supervisor、协作模式 | Agent成功率>95% |
| **Q4** | 10-12月 | 学习优化 | 行为追踪、反馈机制、策略优化 | 策略切换率>30% |

---

## 📅 详细实施计划

## Q1 2026 (1-3月): 基础重构 - 紧急修复阶段

### 目标
修复所有P0/P1问题，建立技术基础，为后续开发扫清障碍

### Week 1-2: 紧急Bug修复 (P0优先级)

#### 任务清单

**1. 修复AI聊天渲染Bug** 🔴
```bash
# 参考文档: plan1.md (UI修复方案)
# 问题: AI流式输出仅显示2字符后停止
# 根本原因: TDesign Chat组件缓存对象引用

# 方案A (推荐): 自定义聊天UI
- [ ] 创建 MessageList.vue (自定义消息列表)
- [ ] 创建 MessageItem.vue (单条消息组件)
- [ ] 创建 ChatInput.vue (输入组件)
- [ ] 创建 ChatToolbar.vue (工具栏)
- [ ] 实现流式数据累积逻辑
- [ ] 移除TDesign Chat依赖

# 方案B (备选): 强制刷新TDesign
- [ ] 实现 chatKey 强制刷新机制
- [ ] 优化累积逻辑
- [ ] 保留TDesign依赖

# 验收标准
✅ AI回复完整显示 (不再中断)
✅ 流式输出流畅
✅ 支持停止生成
✅ 支持重新生成
```

**2. 修复安全问题** 🔴
```bash
# 参考文档: pb1.md (安全问题)
# 问题: API Key明文存储

- [ ] 实现API Key加密存储
- [ ] 使用系统密钥链 (macOS Keychain/Windows Credential Manager)
- [ ] 迁移现有明文Key
- [ ] 添加Key验证机制

# 验收标准
✅ 所有Key加密存储
✅ 数据库无明文Key
✅ 支持Key导入导出
```

#### 技术方案

**自定义聊天UI核心代码**:
```vue
<!-- MessageList.vue -->
<template>
  <div class="message-list" ref="scrollRef">
    <TransitionGroup name="message">
      <MessageItem
        v-for="msg in messages"
        :key="msg.id"
        :message="msg"
        :is-streaming="msg.id === streamingId"
      />
    </TransitionGroup>
    <div v-if="messages.length === 0" class="empty-state">
      <NEmpty description="开始对话吧！" />
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, watch } from 'vue';
import { EventsOn, EventsOff } from '@/wailsjs/runtime';
import MessageItem from './MessageItem.vue';

const messages = ref<Message[]>([]);
const streamingId = ref<string>('');
const streamBuffer = ref('');

EventsOn('agent-message', (data) => {
  if (data.role === 'assistant') {
    streamBuffer.value += data.content || '';
    const currentMsg = messages.value.find(m => m.id === streamingId.value);
    if (currentMsg) {
      currentMsg.content = streamBuffer.value;
    }
  }
});
</script>
```

### Week 3-4: 架构重构

#### 任务清单

**1. 引入状态管理 (Pinia)** 🟡
```bash
# 参考文档: pb1.md (架构问题)、plan1.md (优化方案)
# 问题: 无全局状态管理

- [ ] 安装Pinia: npm install pinia
- [ ] 创建Store结构:
    ├── stores/
    │   ├── config.ts (AI配置)
    │   ├── chat.ts (聊天状态)
    │   ├── user.ts (用户画像)
    │   └── strategy.ts (策略配置)
- [ ] 迁移现有配置到Store
- [ ] 更新组件使用Store
- [ ] 实现状态持久化 (localStorage)

# 验收标准
✅ 所有状态统一管理
✅ 组件间通信简化
✅ 支持状态持久化
```

**2. 实现分层架构** 🟡
```bash
# 参考文档: pb1.md (架构问题)

- [ ] 创建Service层:
    ├── services/
    │   ├── AgentService.ts (AI调用)
    │   ├── StockService.ts (股票数据)
    │   ├── UserService.ts (用户管理)
    │   └── StrategyService.ts (策略管理)

- [ ] 创建Composables:
    ├── composables/
    │   ├── useChat.ts (聊天逻辑)
    │   ├── useStream.ts (流式处理)
    │   └── useMessage.ts (消息管理)

- [ ] 创建API层:
    ├── api/
    │   ├── agent.ts
    │   ├── stock.ts
    │   └── user.ts

# 验收标准
✅ 清晰的分层结构
✅ 组件不直接调用API
✅ 可复用的业务逻辑
```

**3. 组件库统一 (移除TDesign)** 🟢
```bash
# 参考文档: plan1.md (组件库混用问题)

- [ ] 评估: 确认Naive UI可替代所有TDesign组件
- [ ] 替换TDesign Chat → 自定义组件
- [ ] 替换TDesign Button → Naive UI Button
- [ ] 统一主题系统
- [ ] 移除TDesign依赖

# 验收标准
✅ 单一UI库 (Naive UI)
✅ 包体积减少30%
✅ 样式无冲突
```

### Week 5-8: 个性化系统基础

#### 任务清单

**1. 数据库设计** 🟡
```bash
# 参考文档: agent1.md (数据库Schema)

- [ ] 创建用户画像表 (user_profiles)
- [ ] 创建投资策略表 (investment_strategies)
- [ ] 创建用户策略关联表 (user_strategies)
- [ ] 创建Agent技能表 (agent_skills)
- [ ] 创建Agent配置表 (agent_configs)
- [ ] 创建协作历史表 (collaboration_history)
- [ ] 创建行为追踪表 (user_behaviors)

# SQL脚本位置: migrations/001_personalized_agent.sql
```

**2. 后端API开发** 🟡
```bash
# 参考文档: agent1.md (API接口设计)

- [ ] user_profile_api.go (用户画像CRUD)
- [ ] strategy_api.go (策略管理API)
- [ ] agent_builder.go (动态Agent构建器)
- [ ] agent_config_api.go (Agent配置API)
- [ ] behavior_tracker.go (行为追踪)

# API设计原则
- RESTful风格
- 统一错误处理
- 请求/响应验证
- API文档 (Swagger)
```

**3. 预设策略模板** 🟡
```bash
# 参考文档: agent1.md (策略模板)

- [ ] 保守价值策略
  - 低PE/PB、高股息、稳定盈利
  - 工具白名单: [QueryStockPriceInfo, FinancialReport, QueryStockKLine]
  - 最大仓位: 30%
  - 止损: -8%, 止盈: +15%

- [ ] 稳健成长策略
  - 平衡风险收益
  - 工具白名单: [11个工具的全集]
  - 最大仓位: 40%
  - 止损: -10%, 止盈: +25%

- [ ] 激进进取策略
  - 高成长、新兴行业
  - 工具白名单: [QueryMarketNews, ChoiceStockByIndicators, IndustryResearchReport]
  - 最大仓位: 50%
  - 止损: -15%, 止盈: +50%

- [ ] 量化选股策略
- [ ] 主题投资策略
- [ ] 股息策略
- [ ] 动量策略
- [ ] GARP策略
```

**4. 前端UI基础** 🟡
```bash
# 参考文档: agent1.md (前端UI开发)

- [ ] 用户画像设置页面
  - 投资者问卷表单 (10题)
  - 画像展示和编辑
  - 风险评估测试

- [ ] 策略管理页面
  - 策略列表展示
  - 策略详情查看
  - 策略切换功能

- [ ] Agent配置页面
  - 模型选择器
  - 提示词编辑器
  - 工具开关配置

# 验收标准
✅ 新用户3分钟内完成画像设置
✅ 策略切换即时生效
✅ 所有配置有明确说明
```

### Week 9-12: 测试与优化

#### 任务清单

**1. 测试覆盖** 🟢
```bash
- [ ] 单元测试 (后端Go)
- [ ] 组件测试 (前端Vue)
- [ ] 集成测试 (端到端)
- [ ] 性能测试
- [ ] 安全测试

# 目标覆盖率: >70%
```

**2. 性能优化** 🟢
```bash
# 参考文档: plan1.md (性能优化)

- [ ] 实现虚拟滚动 (消息列表)
- [ ] 图片懒加载
- [ ] 组件懒加载
- [ ] 清理console.log
- [ ] 使用computed缓存
- [ ] 添加防抖/节流

# 目标
✅ 首屏加载 <1.5s
✅ 100+消息流畅
✅ 内存稳定
```

**3. 文档完善** 🟢
```bash
- [ ] API文档更新
- [ ] 架构文档更新
- [ ] 用户使用手册
- [ ] 开发者贡献指南
- [ ] 部署文档
```

### Q1 交付物

```
✅ 修复完成:
   - AI聊天渲染问题解决
   - 安全问题修复
   - 所有P0/P1问题清零

✅ 技术基础:
   - Pinia状态管理
   - 分层架构实现
   - 统一UI库
   - 完整测试覆盖

✅ 个性化基础:
   - 数据库Schema创建
   - 后端API实现
   - 8个预设策略模板
   - 基础UI页面

✅ 文档:
   - API文档
   - 架构文档
   - 使用手册
```

---

## Q2 2026 (4-6月): 个性化Agent开发阶段

### 目标
实现用户画像驱动的个性化Agent系统，建立差异化竞争力

### Month 4: Agent构建器核心

#### 任务清单

**1. PersonalizedAgentBuilder** 🔴
```bash
# 参考文档: agent1.md (Agent构建器)

- [ ] BaseAgent基类设计
- [ ] PersonalizedAgentBuilder实现
- [ ] 工具筛选引擎 (ToolSelector)
- [ ] 提示词合成引擎 (PromptBuilder)
- [ ] 参数配置引擎 (ConfigBuilder)

# 核心代码结构
type PersonalizedAgentBuilder struct {
    userProfile    data.UserProfile
    strategy       data.InvestmentStrategy
    activeSkills   []data.AgentSkill
    aiConfig       data.AIConfig
}

func (b *PersonalizedAgentBuilder) Build() (*react.Agent, error) {
    // 1. 创建模型
    // 2. 筛选工具
    // 3. 构建提示词
    // 4. 创建Agent
}

# 验收标准
✅ 可以根据用户画像构建差异化Agent
✅ 不同策略使用不同工具组合
✅ 系统提示词动态调整
✅ 测试覆盖率 >80%
```

**2. 策略推荐引擎** 🟡
```bash
# 参考文档: agent1.md (策略推荐)

- [ ] 规则引擎实现
  - 风险偏好规则
  - 资金量规则
  - 经验水平规则
  - 市场环境规则

- [ ] 问卷系统实现
  - 风险评估问卷
  - 投资目标问卷
  - 画像生成算法

- [ ] 策略匹配算法
  - 协同过滤
  - 内容推荐
  - 混合推荐

# 验收标准
✅ 可以根据画像推荐3-5个适合策略
✅ 推荐准确率 >70%
✅ 问卷完成时间 <3分钟
```

**3. 技能系统实现** 🟡
```bash
# 参考文档: agent1.md (技能系统)

- [ ] 技能库实现
  - 技术面分析技能
  - 基本面选股技能
  - 市场情绪研判技能
  - 风险控制技能

- [ ] 技能依赖检查
  - 前置技能验证
  - 技能等级匹配
  - 工具依赖检查

- [ ] 技能激活/停用API

# 验收标准
✅ 技能库包含8+技能
✅ 支持技能组合
✅ 技能依赖正确验证
```

### Month 5: 前端UI开发

#### 任务清单

**1. 用户画像页面** 🟡
```bash
- [ ] 投资者问卷表单
  - 10个核心问题
  - 动态表单验证
  - 进度指示

- [ ] 画像展示页面
  - 雷达图展示
  - 风险偏好可视化
  - 投资风格标签

- [ ] 画像编辑功能
  - 表单编辑
  - 实时预览
  - 保存确认

# UI设计原则
- 简洁 (问卷不超过10题)
- 智能 (根据输入自动推荐)
- 可视化 (图表展示)
- 引导 (新用户流程)
```

**2. 策略管理页面** 🟡
```bash
- [ ] 策略列表页面
  - 卡片式展示
  - 策略对比
  - 风险等级标识

- [ ] 策略详情页面
  - 策略说明
  - 历史表现
  - 适用人群

- [ ] 策略切换功能
  - 一键切换
  - 确认提示
  - 效果预览

- [ ] 自定义策略编辑器
  - 提示词编辑
  - 工具选择
  - 参数配置
```

**3. Agent配置页面** 🟡
```bash
- [ ] 模型选择器
  - 多模型展示
  - 参数配置
  - 测试连接

- [ ] 技能配置器
  - 技能列表展示
  - 技能激活/停用
  - 技能组合建议

- [ ] 提示词编辑器
  - 语法高亮
  - 模板库
  - 预览功能

- [ ] 工具开关配置
  - 工具列表
  - 权重配置
  - 依赖关系展示
```

**4. 性能追踪页面** 🟢
```bash
- [ ] 策略收益曲线
  - ECharts集成
  - 多周期展示
  - 对标基准

- [ ] 胜率统计
  - 整体胜率
  - 分策略胜率
  - 趋势分析

- [ ] 最大回撤分析
  - 回撤计算
  - 历史对比
  - 风险提示
```

### Month 6: 测试与优化

#### 任务清单

**1. 功能测试** 🟢
```bash
- [ ] 用户画像创建流程
- [ ] 策略推荐准确性
- [ ] Agent构建成功率
- [ ] 策略切换功能
- [ ] 自定义策略创建

# 测试目标
✅ 功能完整度 100%
✅ 用户转化率 >50%
✅ 策略使用率 >30%
```

**2. 性能测试** 🟢
```bash
- [ ] Agent构建性能
  - 目标: <500ms

- [ ] API响应时间
  - 目标: <200ms

- [ ] 数据库查询优化
  - 目标: <100ms

- [ ] 前端渲染优化
  - 目标: 60fps
```

**3. 用户测试** 🟢
```bash
- [ ] Beta用户招募 (20-50人)
- [ ] 用户反馈收集
- [ ] 可用性测试
- [ ] A/B测试 (不同UI方案)
- [ ] 问题修复和迭代
```

### Q2 交付物

```
✅ 个性化系统:
   - 用户画像系统完整
   - 8个预设策略模板
   - 动态Agent构建器
   - 策略推荐引擎

✅ 技能系统:
   - 8个核心技能
   - 技能依赖管理
   - 技能激活API

✅ 前端UI:
   - 用户画像设置页面
   - 策略管理页面
   - Agent配置页面
   - 性能追踪页面

✅ 测试验证:
   - 功能测试通过
   - 性能达标
   - 用户反馈积极
```

---

## Q3 2026 (7-9月): 多Agent协作系统阶段

### 目标
实现Supervisor主控Agent和8个专业Agent，建立技术壁垒

### Month 7: Supervisor Agent开发

#### 任务清单

**1. Supervisor Agent核心** 🔴
```bash
# 参考文档: plan3.md (Supervisor设计)

- [ ] 任务分解引擎
  - 意图识别
  - 任务图谱生成
  - 依赖关系分析

- [ ] Agent调度器
  - 并行执行调度
  - 串行执行调度
  - 超时和重试机制

- [ ] 结果综合器
  - 多源信息融合
  - 冲突解决机制
  - 置信度评估

- [ ] 质量控制器
  - 输出验证
  - 一致性检查
  - 质量评分

# 核心代码结构
type SupervisorAgent struct {
    ctx             context.Context
    specialists     map[string]SpecialistAgent
    userProfile     UserProfile
    activeStrategy  InvestmentStrategy
    taskQueue       chan Task
    resultBuffer    sync.Map
}

func (s *SupervisorAgent) ProcessRequest(userQuery string) (*InvestmentAdvice, error) {
    // 1. 理解意图
    // 2. 任务分解
    // 3. 调度执行
    // 4. 综合结果
    // 5. 质量控制
}

# 验收标准
✅ 可以理解复杂投资问题
✅ 任务分解准确率 >85%
✅ 并行调度正确
✅ 结果综合合理
```

**2. Agent通信协议** 🟡
```bash
- [ ] Message定义
  - 消息类型定义
  - 消息格式规范
  - 序列化/反序列化

- [ ] 通信管道
  - 同步通信
  - 异步通信
  - 广播通信

- [ ] 消息路由
  - 点对点路由
  - 发布订阅
  - 消息过滤
```

**3. 协作模式实现** 🟡
```bash
# 参考文档: plan3.md (协作模式)

- [ ] 串行协作模式
  - Agent Chain实现
  - 依赖关系管理
  - 状态传递

- [ ] 并行协作模式
  - 并发执行引擎
  - 结果聚合
  - 错误处理

- [ ] 迭代优化模式
  - 反馈循环
  - 参数调优
  - 收敛判断
```

### Month 8: 专业Agent开发

#### 任务清单

**1. 核心Agent (优先级最高)** 🔴
```bash
# 参考文档: plan3.md (专业Agent设计)

- [ ] Macro Agent (宏观分析专家)
  - 经济周期判断
  - 政策环境分析
  - 流动性分析
  - 市场情绪评估
  - 工具: [QueryEconomicData, QueryMarketNews]

- [ ] Company Agent (公司研究专家)
  - 商业模式分析
  - 财务分析
  - 估值建模
  - 催化因素追踪
  - 工具: [FinancialReport, QueryStockCodeInfo, InteractiveAnswerData]

- [ ] Technical Agent (技术分析专家)
  - 趋势分析
  - 量价分析
  - 技术指标
  - 支撑阻力
  - 工具: [QueryStockKLine, QueryStockPriceInfo]

# 每个Agent包含:
- 专用工具集
- 专业提示词
- 分析框架
- 输出模板
```

**2. 进阶Agent** 🟡
```bash
- [ ] Industry Agent (行业研究专家)
  - 行业生命周期分析
  - 竞争格局分析
  - 产业链分析
  - 驱动因素追踪
  - 工具: [IndustryResearchReport, QueryBKDict]

- [ ] Risk Agent (风险管理师)
  - 风险识别
  - 风险量化
  - 风险控制
  - 压力测试
  - 工具: [QueryStockKLine, FinancialReport]

- [ ] Portfolio Agent (组合管理专家)
  - 资产配置
  - 组合构建
  - 再平衡
  - 业绩归因
  - 工具: [所有工具的综合应用]
```

**3. 增强Agent** 🟢
```bash
- [ ] Sentiment Agent (情绪分析专家)
  - 新闻情绪分析
  - 社交媒体分析
  - 资金流向追踪
  - 市场广度分析
  - 工具: [QueryMarketNews, QueryStockNews]

- [ ] Strategy Agent (策略优化专家)
  - 策略回测
  - 参数优化
  - 风险调整
  - 收益归因
  - 工具: [所有工具 + 回测引擎]
```

### Month 9: 协作与集成

#### 任务清单

**1. 协作流程实现** 🟡
```bash
# 参考文档: plan3.md (协作模式)

- [ ] 串行协作完整流程
  示例: 股票分析流程
  Supervisor → Macro → Industry → Company → Technical → Risk → 综合建议

- [ ] 并行协作完整流程
  示例: 市场配置分析
  Supervisor → [Macro并行] + [Industry并行] + [Risk并行] → Portfolio综合

- [ ] 迭代优化流程
  示例: 组合优化
  Supervisor → Portfolio分析 →发现问题→Company深挖→Risk验证→Portfolio优化
```

**2. 前端集成** 🟡
```bash
- [ ] Agent状态可视化
  - Agent工作状态展示
  - 任务进度显示
  - 实时结果呈现

- [ ] 协作过程展示
  - 调度流程可视化
  - Agent间通信展示
  - 最终结果呈现

- [ ] 交互优化
  - Agent切换控制
  - 参数实时调整
  - 中断和恢复
```

**3. 性能优化** 🟢
```bash
- [ ] 并发执行优化
  - Goroutine池管理
  - 资源调度优化
  - 负载均衡

- [ ] 缓存策略
  - Agent结果缓存
  - 数据源缓存
  - 智能缓存失效

- [ ] 响应速度优化
  - 增量更新
  - 流式输出
  - 预加载机制
```

### Q3 交付物

```
✅ Supervisor系统:
   - 主控Agent完整实现
   - 任务分解引擎
   - 调度执行引擎
   - 结果综合引擎

✅ 专业Agent:
   - 8个专业Agent完整实现
   - 每个Agent具备独立分析能力
   - 支持独立调用和协作调用

✅ 协作系统:
   - 串行协作模式
   - 并行协作模式
   - 迭代优化模式

✅ 前端集成:
   - Agent状态可视化
   - 协作过程展示
   - 交互优化完成

✅ 性能优化:
   - 并发优化
   - 缓存策略
   - 响应速度提升
```

---

## Q4 2026 (10-12月): 学习优化与高级功能阶段

### 目标
建立持续学习机制，实现Agent自我优化，构建竞争壁垒

### Month 10: 行为追踪系统

#### 任务清单

**1. 行为数据收集** 🟡
```bash
# 参考文档: agent1.md (行为追踪)

- [ ] 用户操作记录表
  - 操作类型定义
  - 数据结构设计
  - 存储优化

- [ ] 建议采纳率追踪
  - 建议记录
  - 用户操作记录
  - 采纳率计算

- [ ] 交易记录关联
  - 交易数据导入
  - 建议与交易关联
  - 收益计算

- [ ] 行为分析API
  - 操作统计
  - 趋势分析
  - 异常检测
```

**2. 反馈机制** 🟡
```bash
- [ ] 建议评分系统
  - 5星评分
  - 标签反馈
  - 文本反馈

- [ ] 实际收益录入
  - 手动录入
  - 自动导入
  - 数据验证

- [ ] 体验反馈收集
  - 定期问卷
  - 随机调研
  - 问题反馈

# 数据模型
type UserFeedback struct {
    SuggestionID   string
    Rating         int  // 1-5星
    Tags           []string
    TextFeedback   string
    ActualReturn   float64
    MarketReturn   float64
    Timestamp      time.Time
}
```

**3. 数据分析引擎** 🟡
```bash
- [ ] 行为模式识别
  - 常用功能识别
  - 操作路径分析
  - 使用频率统计

- [ ] 策略效果分析
  - 收益计算
  - 风险评估
  - 归因分析

- [ ] 用户画像更新
  - 隐式画像更新
  - 显式画像验证
  - 画像演化追踪
```

### Month 11: 学习优化系统

#### 任务清单

**1. 策略优化引擎** 🟡
```bash
- [ ] A/B测试框架
  - 实验设计
  - 流量分配
  - 效果评估

- [ ] 策略参数自动调优
  - 参数空间搜索
  - 效果评估
  - 最优参数选择

- [ ] 个性化推荐算法
  - 协同过滤
  - 内容推荐
  - 混合推荐
  - 冷启动处理
```

**2. Agent自我进化** 🟡
```bash
- [ ] 提示词优化
  - 用户反馈分析
  - 高质量回复学习
  - 提示词A/B测试

- [ ] 工具使用优化
  - 工具效果分析
  - 工具组合优化
  - 新工具建议

- [ ] 分析框架改进
  - 成功案例学习
  - 失败案例复盘
  - 分析方法迭代
```

**3. 报告生成系统** 🟡
```bash
- [ ] 月度策略报告
  - 策略表现总结
  - 收益归因分析
  - 风险提示

- [ ] 行业洞察报告
  - 市场趋势分析
  - 行业机会识别
  - 风险预警

- [ ] 个性化建议报告
  - 基于用户行为
  - 定制化建议
  - 行动计划

# 报告模板
type MonthlyReport struct {
    ExecutiveSummary   string
    StrategyPerformance PerformanceData
    RiskAnalysis      RiskData
    Recommendations   []Recommendation
    ActionItems       []ActionItem
}
```

### Month 12: 高级功能开发

#### 任务清单

**1. 策略分享市场** 🟢
```bash
- [ ] 策略导出/导入
  - JSON格式
  - 版本控制
  - 签名验证

- [ ] 策略评分和排行
  - 评分系统
  - 排行榜
  - 评论系统

- [ ] 大师策略订阅
  - 订阅机制
  - 费用分成
  - 权益保护
```

**2. 智能诊断** 🟢
```bash
- [ ] 投资组合健康度检查
  - 分散度分析
  - 风险评估
  - 收益归因

- [ ] 风险预警
  - 实时监控
  - 阈值告警
  - 预警通知

- [ ] 优化建议
  - 自动诊断
  - 优化方案
  - 实施指导
```

**3. 模拟交易** 🟢
```bash
- [ ] 纸面交易功能
  - 虚拟资金
  - 实时行情
  - 交易记录

- [ ] 策略回测
  - 历史数据
  - 回测引擎
  - 性能指标

- [ ] 历史表现分析
  - 收益曲线
  - 回撤分析
  - 归因分析
```

**4. 社区功能** 🟢
```bash
- [ ] 策略讨论区
  - 论坛系统
  - 话题分类
  - 热门推荐

- [ ] 用户交流
  - 即时通讯
  - 群组功能
  - 专家问答

- [ ] 内容生态
  - UGC内容
  - 内容审核
  - 激励机制
```

### Q4 交付物

```
✅ 学习系统:
   - 行为追踪系统
   - 反馈机制
   - 数据分析引擎

✅ 优化系统:
   - A/B测试框架
   - 策略参数优化
   - 个性化推荐

✅ Agent进化:
   - 提示词自动优化
   - 工具使用优化
   - 分析框架改进

✅ 报告系统:
   - 月度策略报告
   - 行业洞察报告
   - 个性化建议

✅ 高级功能:
   - 策略分享市场
   - 智能诊断系统
   - 模拟交易平台
   - 社区功能
```

---

## 📊 成功指标与监控

### 技术指标

| 指标类别 | 指标名称 | 基线 | Q1目标 | Q2目标 | Q3目标 | Q4目标 | 监控方式 |
|---------|---------|------|-------|-------|-------|-------|---------|
| **可用性** | AI渲染Bug修复率 | 0% | 100% | 100% | 100% | 100% | Bug追踪 |
| | Agent构建成功率 | N/A | N/A | >99% | >99% | >99% | 日志统计 |
| | 系统可用性 | 95% | 98% | 99% | 99.5% | 99.9% | 监控告警 |
| **性能** | API响应时间 | 3-5s | <2s | <500ms | <500ms | <300ms | APM |
| | 首屏加载时间 | >2s | <1.5s | <1s | <1s | <0.8s | 性能监控 |
| | 内存使用 | 500MB+ | <300MB | <200MB | <200MB | <150MB | 性能监控 |
| | 测试覆盖率 | 0% | >50% | >70% | >80% | >85% | 测试报告 |
| **质量** | 代码质量评分 | C | B+ | A- | A | A+ | 代码审查 |
| | 安全漏洞数 | 3+ | 0 | 0 | 0 | 0 | 安全扫描 |

### 产品指标

| 指标类别 | 指标名称 | 基线 | Q1目标 | Q2目标 | Q3目标 | Q4目标 | 监控方式 |
|---------|---------|------|-------|-------|-------|-------|---------|
| **用户增长** | 月活跃用户 | 4000 | 5000 | 7000 | 10000 | 15000 | 用户统计 |
| | 用户留存率 | 未知 | 40% | 50% | 60% | 70% | 留存分析 |
| | 付费转化率 | 5% | 6% | 8% | 10% | 12% | 订单统计 |
| **个性化** | 画像完成率 | 0% | N/A | >70% | >80% | >85% | 画像统计 |
| | 策略使用率 | 0% | N/A | >30% | >50% | >60% | 行为分析 |
| | Agent使用频率 | 基线 | +20% | +50% | +100% | +150% | 使用统计 |
| **用户满意度** | NPS评分 | 20 | 30 | 40 | 50 | 60 | 问卷调查 |
| | 用户满意度 | 2.5/5 | 3.0/5 | 3.5/5 | 4.0/5 | 4.5/5 | 用户反馈 |
| | 建议采纳率 | 未知 | N/A | >40% | >50% | >60% | 行为追踪 |

### 商业指标

| 指标类别 | 指标名称 | 基线 | Q1目标 | Q2目标 | Q3目标 | Q4目标 | 监控方式 |
|---------|---------|------|-------|-------|-------|-------|---------|
| **收入** | 月营收 | 3.5k | 4k | 6k | 10k | 15k | 财务报表 |
| | ARPU (每用户收入) | 0.88 | 0.80 | 0.86 | 1.00 | 1.00 | 收入分析 |
| | 付费用户数 | 4000 | 5000 | 7000 | 10000 | 15000 | 用户统计 |
| **社区** | GitHub Stars | 基线 | +20% | +50% | +100% | +150% | GitHub |
| | 社区活跃度 | 中 | 中+ | 高 | 很高 | 极高 | 社区统计 |
| | 贡献者数量 | 基线 | +5 | +10 | +20 | +30 | 贡献统计 |

---

## 🎯 关键里程碑

### Milestone 1: 技术基础稳固 (Q1结束)
```
✅ 所有P0/P1问题清零
✅ 架构清晰可扩展
✅ 测试覆盖率>70%
✅ 性能达标
✅ 文档完整

状态: ⏳ 进行中
截止: 2026-03-31
```

### Milestone 2: 个性化系统上线 (Q2结束)
```
✅ 用户画像系统完整
✅ 8个预设策略模板
✅ 动态Agent构建器
✅ 画像完成率>70%
✅ 策略使用率>30%

状态: 📅 计划中
截止: 2026-06-30
```

### Milestone 3: 多Agent系统上线 (Q3结束)
```
✅ Supervisor Agent完整
✅ 8个专业Agent完整
✅ 协作模式全部实现
✅ Agent成功率>95%
✅ 用户满意度>4.0/5.0

状态: 📅 计划中
截止: 2026-09-30
```

### Milestone 4: 学习系统上线 (Q4结束)
```
✅ 行为追踪系统完整
✅ 反馈机制建立
✅ 策略自动优化
✅ 高级功能上线
✅ 商业化启动

状态: 📅 计划中
截止: 2026-12-31
```

---

## 🔄 迭代与反馈循环

### 双周迭代节奏

```
每个Sprint (2周):
├── Day 1-2:  计划与设计
├── Day 3-8:  开发实施
├── Day 9-10: 测试与部署
└── Day 11-12: 复盘与反馈

Review内容:
- 完成度评估
- 质量检查
- 风险识别
- 下期计划调整
```

### 月度回顾机制

```
每月Review:
├── 技术指标回顾
├── 产品指标回顾
├── 商业指标回顾
├── 用户反馈分析
├── 竞品动态分析
└── 下月计划调整

输出物:
- 月度报告
- 指标看板
- 问题清单
- 改进计划
```

### 季度战略调整

```
每季度Review:
├── 路线图执行情况
├── 市场变化分析
├── 用户需求变化
├── 技术趋势评估
└── 战略方向调整

可能调整:
- 优先级重排
- 功能增减
- 资源重新分配
- 时间表调整
```

---

## 🚨 风险管理

### 技术风险

| 风险 | 影响 | 概率 | 缓解措施 |
|------|------|------|---------|
| TDesign组件替换失败 | 高 | 中 | 保留备选方案，渐进式替换 |
| 多Agent协作复杂度超预期 | 高 | 高 | 分阶段实现，先串行后并行 |
| 性能不达标 | 中 | 中 | 性能测试前置，提前优化 |
| 第三方API不稳定 | 中 | 低 | 多数据源备份，本地缓存 |

### 产品风险

| 风险 | 影响 | 概率 | 缓解措施 |
|------|------|------|---------|
| 用户不接受新UI | 高 | 中 | A/B测试，用户反馈驱动 |
| 个性化效果不明显 | 高 | 中 | 数据驱动优化，专家规则辅助 |
| 策略推荐不准确 | 中 | 高 | 持续学习，用户反馈闭环 |
| 竞品快速跟进 | 中 | 中 | 持续创新，建立技术壁垒 |

### 商业风险

| 风险 | 影响 | 概率 | 缓解措施 |
|------|------|------|---------|
| 付费转化不达预期 | 高 | 中 | 优化定价策略，提升价值感知 |
| 开源社区活跃度下降 | 中 | 低 | 持续贡献，维护社区关系 |
| 数据成本超预算 | 中 | 低 | 优化缓存策略，降低API调用 |
| 监管政策变化 | 高 | 低 | 关注政策动向，合规经营 |

### 应急预案

**技术应急预案**:
- 回滚机制: 每个版本保留回滚能力
- 灰度发布: 新功能先开放10%用户
- 监控告警: 实时监控系统状态
- 快速修复: 建立hotfix流程

**产品应急预案**:
- 用户反馈: 建立快速响应机制
- 数据备份: 每日自动备份
- 服务降级: 核心功能优先保障
- 用户补偿: 建立补偿机制

---

## 📚 参考文档索引

### 核心文档

| 文档名称 | 描述 | 优先级 |
|---------|------|-------|
| **roadmap.md** | 本文档 - 整体路线图 | ⭐⭐⭐ |
| **arch.md** | 产品架构分析 | ⭐⭐⭐ |
| **agent1.md** | 个性化Agent实现计划 | ⭐⭐⭐ |
| **plan3.md** | 多Agent系统改造计划 | ⭐⭐⭐ |
| **plan1.md** | UI/UX优化计划 | ⭐⭐ |
| **pb1.md** | 完整问题分析报告 | ⭐⭐ |

### 技术文档

| 文档名称 | 位置 | 描述 |
|---------|------|------|
| API文档 | docs/API.md | 后端API接口文档 |
| 架构文档 | docs/ARCHITECTURE.md | 系统架构设计 |
| 贡献指南 | CONTRIBUTING.md | 开发者贡献指南 |
| 行为准则 | CODE_OF_CONDUCT.md | 社区行为准则 |

### 研究资料

| 来源 | 链接 | 主题 |
|------|------|------|
| IBM | [AI Agents 2025](https://www.ibm.com/think/insights/ai-agents-2025-expectations-vs-reality) | Agent趋势 |
| Anthropic | [Multi-Agent Research](https://www.anthropic.com/engineering/multi-agent-research-system) | 多Agent实践 |
| KPMG | [Agentic AI in Wealth Management](https://kpmg.com/kpmg-us/content/dam/kpmg/pdf/2025/agentic-ai-changing-wealth-mgmt.pdf) | 金融应用 |
| Betterment | [2026 Comparison](https://www.nerdwallet.com/investing/learn/betterment-vs-wealthfront) | 竞品分析 |

---

## ✅ 执行检查清单

### 项目启动前

```
团队准备:
□ [ ] 技术栈确定
□ [ ] 开发环境搭建
□ [ ] CI/CD流程建立
□ [ ] 代码仓库准备
□ [ ] 项目管理工具配置

需求确认:
□ [ ] 利益相关者访谈
□ [ ] 用户需求调研
□ [ ] 竞品分析完成
□ [ ] 技术可行性验证
□ [ ] 资源预算确认
```

### 每个阶段启动前

```
Q1准备:
□ [ ] Bug清单整理
□ [ ] 架构设计方案评审
□ [ ] 状态管理方案确定
□ [ ] UI组件库选型

Q2准备:
□ [ ] 数据库Schema评审
□ [ ] API设计评审
□ [ ] 策略模板准备
□ [ ] 用户画像问卷设计

Q3准备:
□ [ ] Agent设计评审
□ [ ] 协作模式设计
□ [ ] 通信协议确定
□ [ ] 性能测试方案

Q4准备:
□ [ ] 数据分析方案设计
□ [ ] A/B测试方案设计
□ [ ] 报告模板准备
□ [ ] 社区功能设计
```

---

## 🎯 总结

### 核心愿景

**从"单一AI聊天工具"进化为"完整AI投研团队"**

### 改造路径

```
2026 Q1: 修复问题 + 建立基础 → 稳定可用的AI助手
       ↓
2026 Q2: 个性化Agent系统 → 差异化的投资助手
       ↓
2026 Q3: 多Agent协作系统 → 专业级的投研团队
       ↓
2026 Q4: 学习优化 + 高级功能 → 自我进化的智能体
```

### 预期成果

**技术层面**:
- 世界级多Agent投资分析系统
- 领先的个性化AI架构
- 完整的学习闭环

**产品层面**:
- 专业级AI投资助手
- 千人千面的个性化体验
- 持续进化的智能系统

**商业层面**:
- 开源生态标杆项目
- 差异化竞争优势
- 可持续的商业化路径

---

**让我们一起打造下一代AI投资助手!** 🚀

---

*文档版本: v1.0*
*创建日期: 2026-01-18*
*最后更新: 2026-01-18*
*项目: Lumos-Stock AI Agent*
*状态: 📋 待审核*
